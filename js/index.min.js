let mapa=null,capas=[];const cboAnio=document.getElementById("anio"),totalMun=document.getElementById("total"),listaMunicipios=document.getElementById("lista");mapa=L.map("mapa",{center:[17.0669,-96.7203],zoom:7,maxZoom:12});let clusterMunicipios=L.markerClusterGroup({spiderfyOnMaxZoom:!0,showCoverageOnHover:!1,zoomToBoundsOnClick:!0}),markerIcon=L.icon({iconUrl:"css/images/marker-icon.png",iconRetinaUrl:"css/images/marker-icon.png"});L.tileLayer.wms("http://{s}.inegi.org.mx/mdmCache/service/wms?",{attribution:"Derechos Reservados &copy; INEGI",subdomains:["gaiamapas1","gaiamapas2","gaiamapas3","gaiamapas","gaia"],format:"image/jpeg",legendlayer:["c100","c101","c102","c102-r","t700","c102m","c103","c109","c110","c111","c112","c200","c201","c202","c203","c206","c300","c301","c302","c310","c311","c354","c762","c793","c795"],layers:"MapaBaseTopograficov61_sinsombreado"}).addTo(mapa),mapa.scrollWheelZoom.disable(),fetch("./api/cat_anios").then(e=>e.json()).then(e=>{var a=e.cat_anios;a.forEach(e=>{var a=document.createElement("option");a.value=e,a.text=e,cboAnio.add(a),a=null})}),cboAnio.addEventListener("change",function(){clusterMunicipios.clearLayers(),fetch("./api/municipios/"+this.value).then(e=>e.json()).then(e=>{var a=e.municipios,t=listaMunicipios.getElementsByTagName("tbody")[0];t.innerHTML="",a.forEach((e,a)=>{var n='<table class="table text-center">';n+='<tr><th colspan="2">'+e.Municipio+"</th></tr>",n+="<tr><td>Región: "+e.region+"</td>",n+="<td>Distrito: "+e.distrito+"</td></tr>",n+="</table>",n+='<p><a href="https://atlasdegenero.oaxaca.gob.mx/" target="_blank">Conoce más...</a></p>';var i=L.marker([e.lat_dec,e.lon_dec]).bindPopup(n);clusterMunicipios.addLayer(i);var o=document.createElement("tr"),c=document.createElement("td"),r=document.createElement("td"),s=document.createElement("td");c.innerHTML=e.Municipio,r.innerHTML=e.region,s.innerHTML=e.distrito,o.appendChild(c),o.appendChild(r),o.appendChild(s),t.appendChild(o)}),clusterMunicipios.addTo(mapa);var n=a.length;totalMun.innerHTML=n.toString()})});